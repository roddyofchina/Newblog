 <!DOCTYPE html>
  <html>
    <head>
      <!--Import Google Icon Font-->
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="../static/css/materialize.min.css"  media="screen,projection"/>
      <link type="text/css" rel="stylesheet" href="../static/css/index.css"/>
      <link type="text/css" rel="stylesheet" href="../static/editor/css/editormd.css"/>


      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>
    <body>
        <header class="page-header">
            <nav style="background-color:#003F72">
                <a href="#!" class="brand-logo" style="margin-left: 50px;">Roddy</a>
                <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
                <div class="nav-wrapper container col s8 m8 l8">
                    <ul class="hide-on-med-and-down">
                        <li class="active"><a href="/">首页</a></li>
                        <li>
                            <a href="/article/python-full-stack-way/">Python Web开发</a>
                        </li>
                        <li>
                            <a href="/article/python-full-stack-way/">Linux系统运维</a>
                        </li>
                        <li>
                            <a href="/article/python-full-stack-way/">云计算与docker</a>
                        </li>
                        <li>
                            <a href="/article/python-full-stack-way/">Web前端开发</a>
                        </li>
                        <li><a href="/about/">关于</a></li>
                    </ul>
                </div>
            </nav>
        </header>


     <section class="container col s8 m8 l8  article-centent">
        <article>
            <header>
                <h1>Python全栈之路系列之面向对象运算符重载</h1>

                <div class="article-meta">
                    <i class="fa fa-calendar" aria-hidden="true"> 2017年2月19日 10:27</i>
                    <i class="fa fa-folder" aria-hidden="true"> <a href="/category/Python/">Python</a></i>
                    <i class="fa fa-tag" aria-hidden="true"> #Python全栈之路 </i>
                </div>

            </header>
            <div class="article_body">
                <div id="content_body" class="markdown-body editormd-html-preview">

                <p>运算符重载的概念如下：</p>
<ol>
<li>运算符重载让类拦截常规的Python运算；</li><li>类可重载所有Python表达式运算符；</li><li>类也可重载打印、函数调用、属性点号运算等内置运算；</li><li>重载是类实例的行为想内置类型；</li><li>重载是通过提供特殊名称的类方法来实现的；</li></ol>
<h2 id="h2-u5E38u89C1u7684u8FD0u7B97u7B26u91CDu8F7Du65B9u6CD5"><a name="常见的运算符重载方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>常见的运算符重载方法</h2><table>
<thead>
<tr>
<th style="text-align:left">方法</th>
<th style="text-align:left">重载</th>
<th style="text-align:left">调用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>__init__</code></td>
<td style="text-align:left">构造函数</td>
<td style="text-align:left">对象建立：X = Class(args)</td>
</tr>
<tr>
<td style="text-align:left"><code>__del__</code></td>
<td style="text-align:left">解析函数</td>
<td style="text-align:left">X对象收回</td>
</tr>
<tr>
<td style="text-align:left"><code>__add__</code></td>
<td style="text-align:left">运算符+</td>
<td style="text-align:left">如果没有<code>__iadd__</code>,X+Y,X+=Y</td>
</tr>
<tr>
<td style="text-align:left"><code>__or__</code></td>
<td style="text-align:left">运算符或</td>
<td style="text-align:left">如果没有<code>__ior__</code></td>
</tr>
<tr>
<td style="text-align:left"><code>__repr__</code>,<code>__str__</code></td>
<td style="text-align:left">打印、转换</td>
<td style="text-align:left">print(X)、repr(X)、str(X)</td>
</tr>
<tr>
<td style="text-align:left"><code>__call__</code></td>
<td style="text-align:left">函数调用</td>
<td style="text-align:left">X(<em>args, *</em>kwargs)</td>
</tr>
<tr>
<td style="text-align:left"><code>__getattr__</code></td>
<td style="text-align:left">点号运算</td>
<td style="text-align:left">X.undefined</td>
</tr>
<tr>
<td style="text-align:left"><code>__setattr__</code></td>
<td style="text-align:left">属性赋值语句</td>
<td style="text-align:left">X.any = value</td>
</tr>
<tr>
<td style="text-align:left"><code>__delattr__</code></td>
<td style="text-align:left">属性删除</td>
<td style="text-align:left">del X.any</td>
</tr>
<tr>
<td style="text-align:left"><code>__getattribute__</code></td>
<td style="text-align:left">属性获取</td>
<td style="text-align:left">X.any</td>
</tr>
<tr>
<td style="text-align:left"><code>__getitem__</code></td>
<td style="text-align:left">索引运算</td>
<td style="text-align:left">X[key]，X[i:j]，没<code>__iter__</code>时的for循环和其他迭代器</td>
</tr>
<tr>
<td style="text-align:left"><code>__setitem__</code></td>
<td style="text-align:left">索引赋值语句</td>
<td style="text-align:left">X[key]=value,X[i:k]=sequence</td>
</tr>
<tr>
<td style="text-align:left"><code>__delitem__</code></td>
<td style="text-align:left">索引和分片删除</td>
<td style="text-align:left">del X[key], del X[i:j]</td>
</tr>
<tr>
<td style="text-align:left"><code>__len__</code></td>
<td style="text-align:left">长度</td>
<td style="text-align:left">len(X)，如果没有<code>__bool__</code>，真值测试</td>
</tr>
<tr>
<td style="text-align:left"><code>__bool__</code></td>
<td style="text-align:left">布尔测试</td>
<td style="text-align:left">bool(X)，真测试</td>
</tr>
<tr>
<td style="text-align:left"><code>__lt__</code>，<code>__gt__</code>，<code>__le__</code>，<code>__ge__</code>，<code>__eq__</code>，<code>__ne__</code></td>
<td style="text-align:left">特定的比较</td>
<td style="text-align:left">X<y，x>Y…</y，x></td>
</tr>
<tr>
<td style="text-align:left"><code>__radd__</code></td>
<td style="text-align:left">右侧加法</td>
<td style="text-align:left">Other + X</td>
</tr>
<tr>
<td style="text-align:left"><code>__iadd__</code></td>
<td style="text-align:left">增强的加法</td>
<td style="text-align:left">X += Y</td>
</tr>
<tr>
<td style="text-align:left"><code>__iter__</code>，<code>__next__</code></td>
<td style="text-align:left">迭代环境</td>
<td style="text-align:left">I=iter(X),next(I)</td>
</tr>
<tr>
<td style="text-align:left"><code>__contains__</code></td>
<td style="text-align:left">成员关系测试</td>
<td style="text-align:left">item in X(任何可迭代对象)</td>
</tr>
<tr>
<td style="text-align:left"><code>__index__</code></td>
<td style="text-align:left">整数值</td>
<td style="text-align:left">hex(X),bin(X),oct(X),o[X],O[X:]</td>
</tr>
<tr>
<td style="text-align:left"><code>__enter__</code>,<code>__exit__</code></td>
<td style="text-align:left">环境管理器</td>
<td style="text-align:left">with obj as var:</td>
</tr>
<tr>
<td style="text-align:left"><code>__get__</code>,<code>__set__</code>,<code>__delete__</code></td>
<td style="text-align:left">描述符属性</td>
<td style="text-align:left">X.attr，X.attr=Value,del X.attr</td>
</tr>
<tr>
<td style="text-align:left"><code>__new__</code></td>
<td style="text-align:left">创建</td>
<td style="text-align:left">在<code>__init__</code>之前创建对象</td>
</tr>
</tbody>
</table>
<p>所有重载方法的名称前后都有两个下划线字符，以便把同类中定义的变量名区别开来。</p>
<h3 id="h3--code-__init__-code-code-__sub__-code-"><a name="构造函数和表达式:<code>__init__</code>和<code>__sub__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>构造函数和表达式:<code>__init__</code>和<code>__sub__</code></h3><pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> start</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">     self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">=</span><span class="pln"> start</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __sub__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L4"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">-</span><span class="pln"> other</span><span class="pun">)</span></code></li><li class="L5"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L6"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> X </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">(</span><span class="lit">5</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> Y </span><span class="pun">=</span><span class="pln"> X </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span></code></li><li class="L8"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> Y</span></code></li><li class="L9"><code class="lang-python"><span class="pun">&lt;</span><span class="pln">__main__</span><span class="pun">.</span><span class="typ">Number</span><span class="pln"> object at </span><span class="lit">0x10224d550</span><span class="pun">&gt;</span></code></li><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> Y</span><span class="pun">.</span><span class="pln">data</span></code></li><li class="L1"><code class="lang-python"><span class="lit">3</span></code></li></ol></pre>
<h3 id="h3--code-__getitem__-code-code-__setitem__-code-"><a name="索引和分片: <code>__getitem__</code>和<code>__setitem__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>索引和分片: <code>__getitem__</code>和<code>__setitem__</code></h3><p>基本索引</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Index</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">def</span><span class="pln"> __getitem__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">return</span><span class="pln"> item </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L4"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span></code></li><li class="L5"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">5</span><span class="pun">):</span></code></li><li class="L6"><code class="lang-python"><span class="pun">...</span><span class="pln">     I </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Index</span><span class="pun">()</span></code></li><li class="L7"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">I</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> end</span><span class="pun">=</span><span class="str">' '</span><span class="pun">)</span></code></li><li class="L8"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L9"><code class="lang-python"><span class="lit">0</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="lit">9</span><span class="pln"> </span><span class="lit">16</span></code></li></ol></pre>
<p>切片索引</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Index</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">   data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">9</span><span class="pun">]</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __getitem__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">):</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'getitem: '</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">)</span></code></li><li class="L4"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data</span><span class="pun">[</span><span class="pln">item</span><span class="pun">]</span></code></li><li class="L5"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __setitem__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">):</span></code></li><li class="L6"><code class="lang-python"><span class="pun">...</span><span class="pln">     self</span><span class="pun">.</span><span class="pln">data</span><span class="pun">[</span><span class="pln">key</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> value</span></code></li><li class="L7"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L8"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> X </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Index</span><span class="pun">()</span></code></li><li class="L9"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">X</span><span class="pun">[</span><span class="lit">1</span><span class="pun">:</span><span class="lit">4</span><span class="pun">])</span></code></li><li class="L0"><code class="lang-python"><span class="pln">getitem</span><span class="pun">:</span><span class="pln">  slice</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">)</span></code></li><li class="L1"><code class="lang-python"><span class="pun">[</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pun">]</span><span class="pln"> </span></code></li><li class="L2"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> X</span><span class="pun">[</span><span class="lit">1</span><span class="pun">:</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L3"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">X</span><span class="pun">[</span><span class="lit">1</span><span class="pun">:</span><span class="lit">4</span><span class="pun">])</span></code></li><li class="L4"><code class="lang-python"><span class="pln">getitem</span><span class="pun">:</span><span class="pln">  slice</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">None</span><span class="pun">)</span></code></li><li class="L5"><code class="lang-python"><span class="pun">[</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span></code></li></ol></pre>
<h3 id="h3--code-__getitem__-code-"><a name="索引迭代：<code>__getitem__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>索引迭代：<code>__getitem__</code></h3><p>如果重载了这个方法，for循环每次循环时都会调用类的<strong>getitem</strong>方法；</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> stepper</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">def</span><span class="pln"> __getitem__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data</span><span class="pun">[</span><span class="pln">item</span><span class="pun">].</span><span class="pln">upper</span><span class="pun">()</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L4"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span></code></li><li class="L5"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> X </span><span class="pun">=</span><span class="pln"> stepper</span><span class="pun">()</span></code></li><li class="L6"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> X</span><span class="pun">.</span><span class="pln">data </span><span class="pun">=</span><span class="pln"> </span><span class="str">'ansheng'</span></code></li><li class="L7"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> X</span><span class="pun">:</span></code></li><li class="L8"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">item</span><span class="pun">)</span></code></li><li class="L9"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L0"><code class="lang-python"><span class="pln">A</span></code></li><li class="L1"><code class="lang-python"><span class="pln">N</span></code></li><li class="L2"><code class="lang-python"><span class="pln">S</span></code></li><li class="L3"><code class="lang-python"><span class="pln">H</span></code></li><li class="L4"><code class="lang-python"><span class="pln">E</span></code></li><li class="L5"><code class="lang-python"><span class="pln">N</span></code></li><li class="L6"><code class="lang-python"><span class="pln">G</span></code></li></ol></pre>
<h3 id="h3--code-__iter__-code-code-__next__-code-"><a name="迭代器对象：<code>__iter__</code>和<code>__next__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>迭代器对象：<code>__iter__</code>和<code>__next__</code></h3><pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Squares</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> start</span><span class="pun">,</span><span class="pln"> stop</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">         self</span><span class="pun">.</span><span class="pln">value </span><span class="pun">=</span><span class="pln"> start </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln">         self</span><span class="pun">.</span><span class="pln">stop </span><span class="pun">=</span><span class="pln"> stop</span></code></li><li class="L4"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __iter__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L5"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">return</span><span class="pln"> self</span></code></li><li class="L6"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __next__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L7"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">if</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">value </span><span class="pun">==</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">stop</span><span class="pun">:</span></code></li><li class="L8"><code class="lang-python"><span class="pun">...</span><span class="pln">             </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">StopIteration</span></code></li><li class="L9"><code class="lang-python"><span class="pun">...</span><span class="pln">         self</span><span class="pun">.</span><span class="pln">value </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L0"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">value </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L2"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> </span><span class="typ">Squares</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">):</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span></code></li><li class="L4"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L5"><code class="lang-python"><span class="lit">1</span></code></li><li class="L6"><code class="lang-python"><span class="lit">4</span></code></li><li class="L7"><code class="lang-python"><span class="lit">9</span></code></li><li class="L8"><code class="lang-python"><span class="lit">16</span></code></li><li class="L9"><code class="lang-python"><span class="lit">25</span></code></li></ol></pre>
<h3 id="h3--code-__contains__-code-code-__iter__-code-code-__getitem__-code-"><a name="成员关系：<code>__contains__</code>、<code>__iter__</code>和<code>__getitem__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>成员关系：<code>__contains__</code>、<code>__iter__</code>和<code>__getitem__</code></h3><pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Iters</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">=</span><span class="pln"> value</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __getitem__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">):</span></code></li><li class="L5"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'get[%s]'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> item</span><span class="pun">,</span><span class="pln"> end</span><span class="pun">=</span><span class="str">''</span><span class="pun">)</span></code></li><li class="L6"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data</span><span class="pun">[</span><span class="pln">item</span><span class="pun">]</span></code></li><li class="L7"><code class="lang-python"></code></li><li class="L8"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __iter__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L9"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'iter&gt;=='</span><span class="pun">,</span><span class="pln"> end</span><span class="pun">=</span><span class="str">''</span><span class="pun">)</span></code></li><li class="L0"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">ix </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L1"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> self</span></code></li><li class="L2"><code class="lang-python"></code></li><li class="L3"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __next__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L4"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'next:'</span><span class="pun">,</span><span class="pln"> end</span><span class="pun">=</span><span class="str">''</span><span class="pun">)</span></code></li><li class="L5"><code class="lang-python"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">ix </span><span class="pun">==</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">data</span><span class="pun">):</span><span class="pln"> </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">StopIteration</span></code></li><li class="L6"><code class="lang-python"><span class="pln">        item </span><span class="pun">=</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data</span><span class="pun">[</span><span class="pln">self</span><span class="pun">.</span><span class="pln">ix</span><span class="pun">]</span></code></li><li class="L7"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">ix </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L8"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> item</span></code></li><li class="L9"><code class="lang-python"></code></li><li class="L0"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __contains__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">):</span></code></li><li class="L1"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'contains: '</span><span class="pun">,</span><span class="pln"> end</span><span class="pun">=</span><span class="str">' '</span><span class="pun">)</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> item </span><span class="kwd">in</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"></code></li><li class="L5"><code class="lang-python"><span class="pln">X </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Iters</span><span class="pun">([</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">])</span></code></li><li class="L6"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="lit">3</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> X</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> X</span><span class="pun">:</span></code></li><li class="L8"><code class="lang-python"><span class="pln">    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> end</span><span class="pun">=</span><span class="str">'|'</span><span class="pun">)</span></code></li><li class="L9"><code class="lang-python"></code></li><li class="L0"><code class="lang-python"><span class="kwd">print</span><span class="pun">([</span><span class="pln">i </span><span class="pun">**</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> X</span><span class="pun">])</span></code></li><li class="L1"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="pln">bin</span><span class="pun">,</span><span class="pln"> X</span><span class="pun">)))</span></code></li><li class="L2"><code class="lang-python"></code></li><li class="L3"><code class="lang-python"><span class="pln">I </span><span class="pun">=</span><span class="pln"> iter</span><span class="pun">(</span><span class="pln">X</span><span class="pun">)</span></code></li><li class="L4"><code class="lang-python"><span class="kwd">while</span><span class="pln"> </span><span class="kwd">True</span><span class="pun">:</span></code></li><li class="L5"><code class="lang-python"><span class="pln">    </span><span class="kwd">try</span><span class="pun">:</span></code></li><li class="L6"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">next</span><span class="pun">(</span><span class="pln">I</span><span class="pun">),</span><span class="pln"> end</span><span class="pun">=</span><span class="str">' @'</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"><span class="pln">    </span><span class="kwd">except</span><span class="pln"> </span><span class="typ">StopIteration</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> e</span><span class="pun">:</span></code></li><li class="L8"><code class="lang-python"><span class="pln">        </span><span class="kwd">break</span></code></li></ol></pre>
<h3 id="h3--code-__getattr__-code-code-__setattr__-code-"><a name="属性引用：<code>__getattr__</code>和<code>__setattr__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>属性引用：<code>__getattr__</code>和<code>__setattr__</code></h3><p>当通过未定义的属性名称和实例通过点号进行访问时，就会用属性名称作为字符串调用这个方法，但如果类使用了继承，并且在超类中可以找到这个属性，那么就不会触发。</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> empty</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">def</span><span class="pln"> __getattr__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">if</span><span class="pln"> item </span><span class="pun">==</span><span class="pln"> </span><span class="str">'age'</span><span class="pun">:</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln">             </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">40</span></code></li><li class="L4"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">else</span><span class="pun">:</span></code></li><li class="L5"><code class="lang-python"><span class="pun">...</span><span class="pln">             </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">AttributeError</span><span class="pun">(</span><span class="pln">item</span><span class="pun">)</span></code></li><li class="L6"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L7"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span></code></li><li class="L8"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> empty</span><span class="pun">()</span></code></li><li class="L9"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">age</span><span class="pun">)</span></code></li><li class="L0"><code class="lang-python"><span class="lit">40</span></code></li><li class="L1"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">name</span><span class="pun">)</span></code></li><li class="L2"><code class="lang-python"><span class="typ">Traceback</span><span class="pln"> </span><span class="pun">(</span><span class="pln">most recent call last</span><span class="pun">):</span></code></li><li class="L3"><code class="lang-python"><span class="pln">  </span><span class="typ">File</span><span class="pln"> </span><span class="str">"&lt;stdin&gt;"</span><span class="pun">,</span><span class="pln"> line </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">module</span><span class="pun">&gt;</span></code></li><li class="L4"><code class="lang-python"><span class="pln">  </span><span class="typ">File</span><span class="pln"> </span><span class="str">"&lt;stdin&gt;"</span><span class="pun">,</span><span class="pln"> line </span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> __getattr__</span></code></li><li class="L5"><code class="lang-python"><span class="typ">AttributeError</span><span class="pun">:</span><span class="pln"> name</span></code></li></ol></pre>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> accesscontrol</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">     </span><span class="kwd">def</span><span class="pln"> __setattr__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">if</span><span class="pln"> key </span><span class="pun">==</span><span class="pln"> </span><span class="str">'age'</span><span class="pun">:</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln">             self</span><span class="pun">.</span><span class="pln">__dict__</span><span class="pun">[</span><span class="pln">key</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> value</span></code></li><li class="L4"><code class="lang-python"><span class="pun">...</span><span class="pln">         </span><span class="kwd">else</span><span class="pun">:</span></code></li><li class="L5"><code class="lang-python"><span class="pun">...</span><span class="pln">             </span><span class="kwd">raise</span><span class="pln"> </span><span class="typ">AttributeError</span><span class="pun">(</span><span class="pln">key </span><span class="pun">+</span><span class="pln"> </span><span class="str">' not allowed'</span><span class="pun">)</span></code></li><li class="L6"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L7"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span></code></li><li class="L8"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> accesscontrol</span><span class="pun">()</span></code></li><li class="L9"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">age </span><span class="pun">=</span><span class="pln"> </span><span class="lit">40</span></code></li><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">age</span><span class="pun">)</span></code></li><li class="L1"><code class="lang-python"><span class="lit">40</span></code></li><li class="L2"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> </span><span class="str">'Hello'</span></code></li><li class="L3"><code class="lang-python"><span class="typ">Traceback</span><span class="pln"> </span><span class="pun">(</span><span class="pln">most recent call last</span><span class="pun">):</span></code></li><li class="L4"><code class="lang-python"><span class="pln">  </span><span class="typ">File</span><span class="pln"> </span><span class="str">"&lt;stdin&gt;"</span><span class="pun">,</span><span class="pln"> line </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">module</span><span class="pun">&gt;</span></code></li><li class="L5"><code class="lang-python"><span class="pln">  </span><span class="typ">File</span><span class="pln"> </span><span class="str">"&lt;stdin&gt;"</span><span class="pun">,</span><span class="pln"> line </span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> __setattr__</span></code></li><li class="L6"><code class="lang-python"><span class="typ">AttributeError</span><span class="pun">:</span><span class="pln"> name </span><span class="kwd">not</span><span class="pln"> allowed</span></code></li></ol></pre>
<h3 id="h3--code-__repr__-code-code-__str__-code-"><a name="<code>__repr__</code>和<code>__str__</code>会返回字符串表达式" class="reference-link"></a><span class="header-link octicon octicon-link"></span><code>__repr__</code>和<code>__str__</code>会返回字符串表达式</h3><p><code>__repr__</code>和<code>__str__</code>都是为了更友好的显示，具体来说，如果在终端下print(Class)则会调用<code>__repr__</code>，非终端下会调用<code>__str__</code>方法，且这两个方法只能返回字符串；</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> adder</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">=</span><span class="lit">0</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">=</span><span class="pln"> value</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __add__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L5"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">+=</span><span class="pln"> other</span></code></li><li class="L6"><code class="lang-python"></code></li><li class="L7"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __repr__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L8"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="str">'addrepr(%s)'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data</span></code></li><li class="L9"><code class="lang-python"></code></li><li class="L0"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __str__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L1"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="str">'N: %s'</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data</span></code></li><li class="L2"><code class="lang-python"></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"><span class="pln">x </span><span class="pun">=</span><span class="pln"> adder</span><span class="pun">(</span><span class="lit">2</span><span class="pun">)</span></code></li><li class="L5"><code class="lang-python"><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L6"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"><span class="kwd">print</span><span class="pun">((</span><span class="pln">str</span><span class="pun">(</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> repr</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)))</span></code></li></ol></pre>
<h3 id="h3--code-__radd__-code-code-__iadd__-code-"><a name="右侧加法和原处加法: <code>__radd__</code>和<code>__iadd__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>右侧加法和原处加法: <code>__radd__</code>和<code>__iadd__</code></h3><p>只有当+右侧的对象是类实例，而左边对象不是类实例的时候，Python才会调用<code>__radd__</code></p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Commuter</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">val </span><span class="pun">=</span><span class="pln"> val</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __add__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L5"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'add'</span><span class="pun">,</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">val</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">)</span></code></li><li class="L6"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">val </span><span class="pun">+</span><span class="pln"> other</span></code></li><li class="L7"><code class="lang-python"></code></li><li class="L8"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __radd__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L9"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'radd'</span><span class="pun">,</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">val</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">)</span></code></li><li class="L0"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> other </span><span class="pun">+</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">val</span></code></li><li class="L1"><code class="lang-python"></code></li><li class="L2"><code class="lang-python"></code></li><li class="L3"><code class="lang-python"><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Commuter</span><span class="pun">(</span><span class="lit">88</span><span class="pun">)</span></code></li><li class="L4"><code class="lang-python"><span class="pln">y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Commuter</span><span class="pun">(</span><span class="lit">99</span><span class="pun">)</span></code></li><li class="L5"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L6"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="str">''</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> y</span><span class="pun">)</span></code></li><li class="L8"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="str">''</span><span class="pun">)</span></code></li><li class="L9"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> y</span><span class="pun">)</span></code></li></ol></pre>
<p>使用<code>__iadd__</code>进行原处加法</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">val </span><span class="pun">=</span><span class="pln"> val</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __iadd__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L5"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">val </span><span class="pun">+=</span><span class="pln"> other</span></code></li><li class="L6"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> self</span></code></li><li class="L7"><code class="lang-python"></code></li><li class="L8"><code class="lang-python"></code></li><li class="L9"><code class="lang-python"><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">(</span><span class="lit">5</span><span class="pun">)</span></code></li><li class="L0"><code class="lang-python"><span class="pln">x </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L1"><code class="lang-python"><span class="pln">x </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L2"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">val</span><span class="pun">)</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"></code></li><li class="L5"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">:</span></code></li><li class="L6"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">):</span></code></li><li class="L7"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">val </span><span class="pun">=</span><span class="pln"> val</span></code></li><li class="L8"><code class="lang-python"></code></li><li class="L9"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __add__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L0"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">val </span><span class="pun">+</span><span class="pln"> other</span><span class="pun">)</span></code></li><li class="L1"><code class="lang-python"></code></li><li class="L2"><code class="lang-python"></code></li><li class="L3"><code class="lang-python"><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Number</span><span class="pun">(</span><span class="lit">5</span><span class="pun">)</span></code></li><li class="L4"><code class="lang-python"><span class="pln">x </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L5"><code class="lang-python"><span class="pln">x </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></code></li><li class="L6"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">.</span><span class="pln">val</span><span class="pun">)</span></code></li></ol></pre>
<h3 id="h3-call-code-__call__-code-"><a name="Call表达式：<code>__call__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>Call表达式：<code>__call__</code></h3><p>当调用类实例时执行<code>__call__</code>方法</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Callee</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __call__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> </span><span class="pun">*</span><span class="pln">args</span><span class="pun">,</span><span class="pln"> </span><span class="pun">**</span><span class="pln">kwargs</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Callee:'</span><span class="pun">,</span><span class="pln"> args</span><span class="pun">,</span><span class="pln"> kwargs</span><span class="pun">)</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"></code></li><li class="L5"><code class="lang-python"><span class="pln">C </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Callee</span><span class="pun">()</span></code></li><li class="L6"><code class="lang-python"><span class="pln">C</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"><span class="pln">C</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> z</span><span class="pun">=</span><span class="lit">3</span><span class="pun">)</span></code></li><li class="L8"><code class="lang-python"></code></li><li class="L9"><code class="lang-python"></code></li><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Prod</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> value</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">value </span><span class="pun">=</span><span class="pln"> value</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __call__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L5"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">value </span><span class="pun">*</span><span class="pln"> other</span></code></li><li class="L6"><code class="lang-python"></code></li><li class="L7"><code class="lang-python"></code></li><li class="L8"><code class="lang-python"><span class="pln">x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Prod</span><span class="pun">(</span><span class="lit">3</span><span class="pun">)</span></code></li><li class="L9"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">(</span><span class="lit">3</span><span class="pun">))</span></code></li><li class="L0"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">(</span><span class="lit">4</span><span class="pun">))</span></code></li></ol></pre>
<h3 id="h3--code-__lt__-code-code-__gt__-code-"><a name="比较:<code>__lt__</code>,<code>__gt__</code>和其他方法" class="reference-link"></a><span class="header-link octicon octicon-link"></span>比较:<code>__lt__</code>,<code>__gt__</code>和其他方法</h3><p>类可以定义方法来捕获所有的6种比较运算符：&lt;、&gt;、&lt;=、&gt;=、==和!=</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> C</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    data </span><span class="pun">=</span><span class="pln"> </span><span class="str">'spam'</span></code></li><li class="L2"><code class="lang-python"></code></li><li class="L3"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __gt__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L4"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">&gt;</span><span class="pln"> other</span></code></li><li class="L5"><code class="lang-python"></code></li><li class="L6"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __lt__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> other</span><span class="pun">):</span></code></li><li class="L7"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">data </span><span class="pun">&lt;</span><span class="pln"> other</span></code></li><li class="L8"><code class="lang-python"></code></li><li class="L9"><code class="lang-python"><span class="pln">x </span><span class="pun">=</span><span class="pln"> C</span><span class="pun">()</span></code></li><li class="L0"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'han'</span><span class="pun">)</span></code></li><li class="L1"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'han'</span><span class="pun">)</span></code></li></ol></pre>
<h3 id="h3--strong-bool-strong-strong-len-strong-"><a name="布尔值测试：<strong>bool</strong>和<strong>len</strong>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>布尔值测试：<strong>bool</strong>和<strong>len</strong></h3><pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __bool__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span></code></li><li class="L3"><code class="lang-python"></code></li><li class="L4"><code class="lang-python"></code></li><li class="L5"><code class="lang-python"><span class="pln">X </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">()</span></code></li><li class="L6"><code class="lang-python"><span class="kwd">if</span><span class="pln"> X</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'yes'</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"></code></li><li class="L8"><code class="lang-python"></code></li><li class="L9"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">:</span></code></li><li class="L0"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __bool__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L1"><code class="lang-python"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">False</span></code></li><li class="L2"><code class="lang-python"></code></li><li class="L3"><code class="lang-python"><span class="pln">X </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">()</span></code></li><li class="L4"><code class="lang-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">bool</span><span class="pun">(</span><span class="pln">X</span><span class="pun">))</span></code></li></ol></pre>
<p>如果没有这个方法，Python退而求其次的求长度，因为一个非空对象看作是真:</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __len__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L3"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> X </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">()</span></code></li><li class="L4"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> X</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'no'</span><span class="pun">)</span></code></li><li class="L5"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L6"><code class="lang-python"><span class="pln">no</span></code></li></ol></pre>
<p>如果两个方法都有，<code>__bool__</code>会胜过<code>__len__</code>：</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __bool__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span></code></li><li class="L2"><code class="lang-python"><span class="pun">...</span><span class="pln">   </span><span class="kwd">def</span><span class="pln"> __len__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span></code></li><li class="L3"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L4"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> X </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">()</span></code></li><li class="L5"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> bool</span><span class="pun">(</span><span class="pln">X</span><span class="pun">)</span></code></li><li class="L6"><code class="lang-python"><span class="kwd">True</span></code></li></ol></pre>
<p>如果两个方法都没有定义，对象毫无疑义的看作为真：</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Truth</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">pass</span></code></li><li class="L1"><code class="lang-python"><span class="pun">...</span><span class="pln"> </span></code></li><li class="L2"><code class="lang-python"><span class="pun">&gt;&gt;&gt;</span><span class="pln"> bool</span><span class="pun">(</span><span class="typ">Truth</span><span class="pun">)</span></code></li><li class="L3"><code class="lang-python"><span class="kwd">True</span></code></li></ol></pre>
<h3 id="h3--code-__del__-code-"><a name="对象解析函数：<code>__del__</code>" class="reference-link"></a><span class="header-link octicon octicon-link"></span>对象解析函数：<code>__del__</code></h3><p>每当实例产生时，就会调用<strong>init</strong>构造函数，每当实例空间被收回时，它的对立面<code>__del__</code>，也就是解析函数，就会自动执行；</p>
<pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="lang-python"><span class="kwd">class</span><span class="pln"> </span><span class="typ">Life</span><span class="pun">:</span></code></li><li class="L1"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> name</span><span class="pun">=</span><span class="str">'unknown'</span><span class="pun">):</span></code></li><li class="L2"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Hello, '</span><span class="pun">,</span><span class="pln"> name</span><span class="pun">)</span></code></li><li class="L3"><code class="lang-python"><span class="pln">        self</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> name</span></code></li><li class="L4"><code class="lang-python"></code></li><li class="L5"><code class="lang-python"><span class="pln">    </span><span class="kwd">def</span><span class="pln"> __del__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">):</span></code></li><li class="L6"><code class="lang-python"><span class="pln">        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'Goodbye'</span><span class="pun">,</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">name</span><span class="pun">)</span></code></li><li class="L7"><code class="lang-python"></code></li><li class="L8"><code class="lang-python"></code></li><li class="L9"><code class="lang-python"><span class="pln">brian </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Life</span><span class="pun">(</span><span class="str">'Brian'</span><span class="pun">)</span></code></li><li class="L0"><code class="lang-python"><span class="pln">brian </span><span class="pun">=</span><span class="pln"> </span><span class="str">'loretta'</span></code></li></ol></pre>
</div>

            </div>
            <div class="article-copyright">
                <p>当前文章非永久URL：https://blog.ansheng.me/article/python-full-stack-way-object-operator-overload/</p>
                <p>创建时间：2017年2月19日 10:27</p>
                <p>更新时间：2017年2月19日 10:29</p>
            </div>
        </article>
    </section>


        <footer class="page-footer" style="background-color:#003F72 ">
                <div class="container">
                    <div class="row">
                        <div class="col l6 s12">
                            <h5 class="white-text">页脚内容</h5>
                            <p class="grey-text text-lighten-4">你可以用行和列来组织你的页脚内容。</p>
                        </div>
                        <div class="col l4 offset-l2 s12">
                            <h5 class="white-text">链接</h5>
                            <ul>
                                <li><a class="grey-text text-lighten-3" href="#!">链接 1</a></li>
                                <li><a class="grey-text text-lighten-3" href="#!">链接 2</a></li>
                                <li><a class="grey-text text-lighten-3" href="#!">链接 3</a></li>
                                <li><a class="grey-text text-lighten-3" href="#!">链接 4</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="footer-copyright">
                    <div class="container">
                        © 2014 Copyright 文本
                        <a class="grey-text text-lighten-4 right" href="#!">更多链接</a>
                    </div>
                </div>
            </footer>

      <!--Import jQuery before materialize.js-->
      <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
      <script type="text/javascript" src="../static/js/materialize.min.js"></script>
    </body>
  </html>